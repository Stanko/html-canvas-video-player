!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CanvasVideoPlayer",[],t):"object"==typeof exports?exports.CanvasVideoPlayer=t():e.CanvasVideoPlayer=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s={framesPerSecond:25,hideVideo:!0,autoplay:!1,audio:!1,timelineActions:!0,timelineSelector:!1,timelinePasedSelector:!1,resetOnLastFrame:!0,loop:!1},a=function(){function e(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,e),this._canvasClickHandler=function(){t.playPause()},this._videoTimeUpdateHandler=function(){t._drawFrame(),t._updateTimeLine()},this._videoCanPlayHandler=function(){t._drawFrame()},this._timeLineClick=function(i){var n=i.clientX-e.getOffset(t._canvas).left;t.jumpTo(n/t._timeline.offsetWidth)},this._windowResizeHandler=function(){t._setCanvasSize(),t._drawFrame()},this._options=n({},s,o),this._video=document.querySelector(this._options.videoSelector),this._canvas=document.querySelector(this._options.canvasSelector),this._timeline=document.querySelector(this._options.timelineSelector),this._timelinePassed=document.querySelector(this._options.timelinePassedSelector),this._options.videoSelector&&this._video?this._options.canvasSelector&&this._canvas?this._options.timelineSelector&&!this._timeline?console.error('Element for the "timelineSelector" selector not found'):this._options.timelineSelector&&!this._timelinePassed?console.error('Element for the "timelinePassed" not found'):(this._options.audio&&this._setAudio(),this._ctx=this._canvas.getContext("2d"),this._playing=!1,void this.init()):console.error('No "canvasSelector" property, or the element is not found'):console.error('No "videoSelector" property, or the element is not found')}return o(e,[{key:"_setAudio",value:function(){return"string"==typeof this._options.audio?(this._audio=document.querySelector(this._options.audio),!this._audio&&console.error('Element for the "audio" not found')):(this._audio=document.createElement("audio"),this._audio.innerHTML=this._video.innerHTML,this._video.parentNode.insertBefore(this._audio,this._video),void this._audio.load())}},{key:"init",value:function(){this._video.load(),this._setCanvasSize(),this._bind(),this._updateTimeLine(),this._options.hideVideo&&(this._video.style.display="none"),this._options.autoplay&&this.play()}},{key:"destroy",value:function(){this.pause(),this._options.audio&&this._audio.parentNode.removeChild(this._audio),this._unbind()}},{key:"jumpTo",value:function(e){this._video.currentTime=this._video.duration*e,this._options.audio&&(this._audio.currentTime=this._audio.duration*e)}},{key:"play",value:function(){this._lastTime=Date.now(),this._playing=!0,this._loop(),this._options.audio&&(this._audio.currentTime=this._video.currentTime,this._audio.play())}},{key:"pause",value:function(){this._playing=!1,this._options.audio&&this._audio.pause()}},{key:"playPause",value:function(){this._playing?this.pause():this.play()}},{key:"_bind",value:function(){window.addEventListener("resize",this._windowResizeHandler),this._canvas.addEventListener("click",this._canvasClickHandler),this._video.addEventListener("timeupdate",this._videoTimeUpdateHandler),this._video.addEventListener("canplay",this._videoCanPlayHandler),this._options.timelineActions&&this._timeline.addEventListener("click",this._timeLineClick),this._video.readyState>=2&&this._drawFrame()}},{key:"_unbind",value:function(){window.removeEventListener("resize",this._windowResizeHandler),this.canvas.removeEventListener("click",this._canvasClickHandler),this.video.removeEventListener("timeupdate",this._videoTimeUpdateHandler),this.video.removeEventListener("canplay",this._videoCanPlayHandler),this._options.timelineActions&&this._timeline.removeEventListener("click",this._timeLineClick)}},{key:"_setCanvasSize",value:function(){this._width=this._canvas.clientWidth,this._height=this._canvas.clientHeight,this._canvas.setAttribute("width",this._width),this._canvas.setAttribute("height",this._height)}},{key:"_updateTimeLine",value:function(){if(this._options.timelineSelector){var e=-100+(this._video.currentTime||0)/this._video.duration*100;this._timelinePassed.style.webkitTransform="translateX("+e+"%)",this._timelinePassed.style.transform="translateX("+e+"%)"}}},{key:"_loop",value:function(){var e=this,t=Date.now(),i=(t-this._lastTime)/1e3,n=this._video.currentTime;i>=1/this._options.framesPerSecond&&(this._video.currentTime=n+i,this._lastTime=t,this._audio&&Math.abs(this._audio.currentTime-n)>.2&&(this._audio.currentTime=n)),n>=this._video.duration&&(this._playing=!1,this._options.resetOnLastFrame===!0&&(this._video.currentTime=0),this._options.loop===!0&&(this._video.currentTime=0,this.play())),this._playing?this._animationFrame=requestAnimationFrame(function(){return e._loop()}):cancelAnimationFrame(this._animationFrame)}},{key:"_drawFrame",value:function(){this._ctx.drawImage(this._video,0,0,this._width,this._height)}}],[{key:"getOffset",value:function(e){if(e){var t=e.getBoundingClientRect(),i=void 0,n=void 0;return t.width||t.height||e.getClientRects().length?(n=e.ownerDocument,i=n.documentElement,{top:t.top+window.pageYOffset-i.clientTop,left:t.left+window.pageXOffset-i.clientLeft}):void 0}}}]),e}();t.default=a,e.exports=t.default}])});
//# sourceMappingURL=canvas-video-player.min.js.map